import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Getting JSON output in {{ service.studio.name }}

By default, a [text generation model](models/text-to-text.md) responds to your requests with natural‑language text.  
When you send a message to the model using the [{{ service.studio.name }} API]({{ service.studio.api-reference }}), you can ask it to respond with **JSON** instead and pass that straight to your application.

> For example, you can give a model the name of an actor or actress and get back details of a film they have starred in, like this:
>
> ```json
> {
>   "title": "The Shining",
>   "year": 1980,
>   "director": "Stanley Kubrick",
>   "cast": ["Jack Nicholson", "Shelley Duvall", "Danny Lloyd"],
>   "genre": "horror"
> }
> ```

Depending on your request settings, the response can be **[guided JSON](#guided-json)** (follows a schema you provide) or **[unguided JSON](#basic-json)** (valid JSON, but the shape is not enforced).

---

<a id="guided-json"></a>
## Guided JSON

_Guided JSON_ is JSON that **must** follow a schema included in your request.

To receive guided JSON:

<Tabs groupId="languages" defaultValue="python">

<TabItem value="python" label="Python">

Define a schema (the example uses [Pydantic](https://docs.pydantic.dev/latest/)) and pass it in `extra_body.guided_json`:

```python
import os
import json
from openai import OpenAI
from typing import List, Literal
from pydantic import BaseModel

# 1  Define the response schema
class Film(BaseModel):
    title: str
    year: int
    director: str
    cast: List[str]
    genre: Literal[
        "drama", "thriller", "sci‑fi",
        "comedy", "horror", "fantasy"
    ]

# 2  Add the schema to your request
client = OpenAI(
    base_url="{{ service.studio.inference.api-endpoint }}/",
    api_key=os.environ["NEBIUS_API_KEY"],
)

completion = client.chat.completions.create(
    model="mistralai/Mistral-Nemo-Instruct-2407",
    messages=[
        {"role": "system",
         "content": "I will give you an actor or actress, and you will respond "
                    "with details of a real film they have starred in, "
                    "according to the provided structure."},
        {"role": "user", "content": "Jack Nicholson"}
    ],
    extra_body={"guided_json": Film.model_json_schema()}
)

# 3  Work with the JSON (or handle a refusal)
msg = completion.choices[0].message
if msg.refusal:
    print(msg.refusal)
elif msg.content:
    try:
        film = json.loads(msg.content)
        print(f"Film: {film['title']} ({film['year']})")
    except Exception as err:
        print("Invalid JSON:", err)
